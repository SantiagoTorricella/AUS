{\rtf1\ansi\ansicpg1252\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;\f1\fswiss\fcharset0 ArialMT;}
{\colortbl;\red255\green255\blue255;\red0\green0\blue0;}
{\*\expandedcolortbl;;\cspthree\c0\c0\c0;}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs24 \cf0 ### Ejercicio 1 ChatGPT\
SELECT a.numero as NumeroAsiento, tp.nombre as TipoDeAsiento, a.planta as Planta, coalesce(eta.precio,ta.precio)\
FROM Viaje v\
JOIN Colectivo c ON v.id_colectivo=c.id\
JOIN Empresa e ON c.id_empresa=e.id\
JOIN Viaje_asiento va ON v.id=va.id_viaje\
JOIN Asiento a ON va.id_asiento=a.id\
JOIN Tipo_asiento ta ON a.id_tipo_asiento=ta.id\
LEFT JOIN Empresa_tipo_asiento eta ON eta.id_tipo_asiento=ta.id AND eta.id_empresa=e.id\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 LEFT JOIN  Pasaje p ON p.id_viaje_asiento=va.id\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 WHERE\
	v.id=101\
	AND e.nombre=\'91FlechaBus\'92\
	AND p.id IS NULL\
\
### Ejercicio 2 ChatGPT\
SELECT a.numero as NumeroAsiento, a.planta as PLANTA, c.nombre as NOMBRECLIENTE, ta.nombre as TIPODEASIENTO, COALESCE(eta.precio,ta.precio) as PRECIO\
FROM Viaje v\
JOIN Colectivo co ON v.id_colectivo = co.id\
JOIN Empresa e ON co.id_empresa = e.id\
JOIN Viaje_asiento va ON v.id=va.id_viaje\
JOIN Pasaje p ON p.id_viaje_asiento=va.id\
JOIN Asiento a ON va.id_asiento=a.id\
JOIN Cliente c ON p.id_cliente=c.id\
JOIN Tipo_asiento ta ON a.id_tipo_asiento=ta.id\
LEFT JOIN empresa_tipo_asiento eta ON eta.id_tipo_asiento=ta.id AND eta.id_empresa=e.id\
WHERE\
	v.id=204\
	e.nombre=\'91viabariloche\'92\
\
### Ejercicio 1 practica\
### 
\f1 \cf2 Cantidad de servicios agrupados por empresa desde Rosario a Bariloche.\
SELECT e.nombre, COUNT(*) as CantidadDeServicios\
FROM Viaje v\
JOIN Colectivo c ON c.id=v.id_colectivo\
JOIN Empresa e ON e.id=c.Id_empresa\
JOIN Parada porigen ON porigen.id_viaje=v.id AND porigen.orden=1\
JOIN Ciudad corigen ON corigen.id=porigen.id_ciudad\
JOIN Parada pdestino ON pdestino.id_viaje=v.id\
JOIN Ciudad cdestino ON c.destino.id=pdestino.id_ciudad\
WHERE\
	corigen.nombre=\'91Rosario\'92\
	AND cdestino.nombre=\'91Bariloche\'92\
	AND pdestino.orden=(SELECT MAX(p2.orden) FROM Parada p2 WHERE p2.id_viaje=v.id)\
GROUP BY e.nombre\
\
## Ejercicio 2 practica\
SELECT \
  c.apellido, \
  c.nombre, \
  COUNT(*) AS cantidad_viajes\
FROM Cliente c\
JOIN Pasaje p ON p.id_cliente = c.id\
JOIN Viaje_asiento va ON va.id = p.id_viaje_asiento\
JOIN Viaje v ON v.id = va.id_viaje\
WHERE v.fecha_salida >= CURRENT_DATE - INTERVAL '1 year'\
GROUP BY c.id, c.apellido, c.nombre\
ORDER BY cantidad_viajes DESC\
LIMIT 3;\
\
## Ejercicio 3 practica\
SELECT \
  e.nombre AS empresa,\
  v.fecha_salida,\
  corigen.nombre AS origen,\
  cdestino.nombre AS destino_final\
FROM Viaje v\
JOIN Colectivo c ON v.id_colectivo = c.id\
JOIN Empresa e ON c.id_empresa = e.id\
\
-- Origen (orden = 1)\
JOIN Parada porigen ON porigen.id_viaje = v.id AND porigen.orden = 1\
JOIN Ciudad corigen ON corigen.id = porigen.id_ciudad\
\
-- Destino (orden m\'e1ximo)\
JOIN Parada pdestino ON pdestino.id_viaje = v.id\
JOIN Ciudad cdestino ON cdestino.id = pdestino.id_ciudad\
  AND pdestino.orden = (\
    SELECT MAX(p2.orden)\
    FROM Parada p2\
    WHERE p2.id_viaje = v.id\
  )\
\
-- Asientos del viaje\
JOIN Viaje_asiento va ON va.id_viaje = v.id\
\
-- Buscar los que NO tienen pasajes\
LEFT JOIN Pasaje p ON p.id_viaje_asiento = va.id\
WHERE p.id IS NULL\
GROUP BY v.id, e.nombre, v.fecha_salida, corigen.nombre, cdestino.nombre;\
\
\
## Ejercicio 4 practica\
SELECT \
  c.nombre AS localidad,\
  p.nombre AS provincia\
FROM Ciudad c\
JOIN Provincia p ON c.id_provincia = p.id\
WHERE LOWER(c.nombre) LIKE '%monte%';}